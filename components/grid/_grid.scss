@import "compass/utilities/general/hacks"; 
@import "compass/css3";

$grids-debug: false;
$grids-debug-position: false;
//TODO: make params into variables instead, so they can easily be updated w out changing this file.
//TODO: Take different units into account, what if gutters are in rems? ems? percentage?
//TODO: test in IE6 :(
@mixin oogrids($cols: (2,3,4,5,6), $gutter: $guttersH){ 
	
	/* ie 7 and earlier need percentage based gutters because they don't do border-box */
	$ie-percent-gutter: percentage($gutter/$pageWidth);

	@each $col in $cols {
		@for $i from 1 through $col {
			.size#{$i}of#{$col} {
				width: percentage($i/$col);
				*width: percentage($i/$col)-$ie-percent-gutter; /* IE7- width = normal width - gutter width */
			}
		}
	}
	.line{
		@include clearfix-me(micro);
		margin-left: -$gutter;
		
		.unit{ 
			float:left;
			zoom:1;
			@if $gutter {
				@include box-sizing(border-box); /*IE8+*/
				padding-left: $gutter;
			}

			&.lastUnit {
				@include clearfix-me(facebook);
				float: none;
				_position: relative;
				_left: -3px;
				_margin-right: -3px;
				/* IE 7 */
			    *display: block;
			    *width: auto;
			    *zoom: 1;
			}
		}
		.unitExt { // TODO: handle case where there are two (or more) unitExt in a line.
			float:right;
			zoom:1;
			@if $gutter {
				padding: 0 0 0 $gutter;
			}
		}
	}
}

@if $grids-debug {
	.unit:before {
		content: "unit";
		display:block;
		min-height: 40px;
		line-height: 40px;
		background-color: #EEE;
		text-align: center;
		border-radius: 3px;
	}
}

@if $grids-debug-position {
	.line{background-color: #e2e2e2;}
	.unit{background-color:#da0000; border-radius: 7px;}
	.unit:first-child{background-color:green;}
	.unit:first-child, .firstUnit{background-color:blue;}
	.unitExt ~ [class*=size]:last-child,.lastUnit{background-color:purple;}
	.unitExt ~ .unitExt{ background-color: gray;}
}

// if gutters were true they would need to be % based, so you would need to know page width
// e.g. 15px gutters / 960px page width = 0.015625 or 1.5625%

// or have them be pixel based and set padding box thingy